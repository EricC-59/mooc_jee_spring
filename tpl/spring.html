<!--
******************************************************************************
                         SPRING
******************************************************************************
-->


        <h2>
          <img src="https://spring.io/images/spring-logo.svg" height="50"/>
          <a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a></h2>


<p>
        <i>&laquo; The Spring Framework provides a comprehensive programming and configuration model <br/>
          for modern Java-based enterprise applications &raquo;</i>
</p>


<p>
          Comprenez que Spring est un "couteau suisse" pour faciliter la vie du développeur Java, spécialement si il développe pour Java EE (mais pas que).<br/>
          La vidéo suivante est une présentation générale de Spring illustrant les concepts mis en oeuvre dans Spring.
</p>

<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/dFaw8NGx6kk?rel=0" frameborder="0" allowfullscreen=""></iframe>
</p>

<p align="center">
<a href="pdf/4.1_spring_introduction.pdf">Transparents présentés dans la vidéo</a>
</p>

<p>
        Le coeur de Spring est un moteur d'injection de dépendances permettant l'<b>inversion de contrôle</b> (en anglais IoC pour Inversion of Control) du cycle de vie des objets. L'IoC permet, entre autre, de "repousser" le choix d'implémentation (ou d'instance) d'un objet inclus dans un autre.
</p>


<p>
          Prenons l'exemple d'un DAO JPA ou JDBC. Imaginons que le développeur de notre interface ne soit pas le même que celui qui réalise la couche de persistance (donc du DAO). Le développeur de l'interface ne connait pas la classe qui sera utilisée, et d'ailleurs il n'a pas envie de faire un <code>new xxxJPADao()</code>, ce qui "casserait" en parti l'abstraction que nous avons essayé de mettre en place. De l'autre coté, le développeur de notre DAO ne sait pas où et comment son implémentation JPA sera utilisée. Il ne peut pas faire <code>view.setDao( ... )</code>
</p>

<p>
        Heureusement il y a Spring. Dans l'interface, on demandera à l'injecteur de dépendances de trouver et d'affecter le DAO, de l'autre on déclarera l'implémentation JPA comme composant DAO à être utilisé. Le tout sera initialisé et affecté au lancement de l'application.
</p>

<p>
        Merci Martin, que ferions-nous sans toi. <br>
        <i> pour votre culture générale </i> : <a href="http://www.martinfowler.com/articles/injection.html">Inversion of Control Containers and the Dependency Injection pattern</a> 
</p>

<h2>L'injection de dépendances</h2>

<p>
  Le principe est de construire des objets, que l'on nommera "composant" et de les mettre à disposition des autres composants.<br/>
Un composant est une instance partagée du contexte Spring, selon le pattern "singleton" par défaut.<br>
Une annotation <code class="ann">@Component</code> permet de définir une classe Java comme un composant Spring. Dans ces objets il sera possible d'utiliser l'annotation <code class="ann">@Autowired</code> pour injecter automatiquement une instance présente dans le contexte et possédant un type compatible.<br/>
Si une injection ne peut pas être satisfaite, alors une erreur sera levée au démarrage du contexte spring.<br/>
Certaines injections pouvant être facultatives, vous pouvez mettre le paramètre "required=false" dans l'annotation Autowired.
</p>

<p>
  Il existe différentes implémentations de contexte Spring. Nous utiliserons généralement <code>AnnotationConfigApplicationContext</code> comme instance d'<code>ApplicationContext</code>. Cette implémentation permet de configurer un contexte Spring à l'aide des annotations que nous avons placées.<br>
  Spring peut rechercher tous les composants (ceux annotés) dans une partie du classpath : cela se configure à l'aide de l'annotation <code class="ann">@ComponentScan</code>.  Spring inspectera la liste des packages passés en paramètre pour constituer son contexte, à l'aide des composants qui y sont définis.<br>
</p>

<p>
  La lecture de la documentation de référence <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html">concernant les beans</a> et surtout <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/html/beans.html#beans-annotation-config">ce paragraphe</a> vous serons sans doute d'une aide précieuse.<br>
</p>

<p>
  L'intérêt de Spring est surtout de réaliser des scénarii d'injection lorsque les objets proviennent de librairies différentes, ou lorsque plusieurs implémentations d'une même classe peuvent être utilisées dans l'application.<br>
  L'inspection des composants du classpath peut se faire dans vos packages ou ceux définis dans une autre librairie (jar).
</p>

</p>
  Cela peut vite devenir complexe de comprendre ce qui se trouve ou non dans le contexte Spring. Il faudra veiller à bien structurer ses packages et la définition de ses composants pour s'y retrouver. Il peut être intéressant d'utiliser un contexte décrit en XML, ou de regrouper la création des objets du contexte dans un objet portant l'annotation <code class="ann">@Configuration</code>.
</p>

<p>
  Si généralement nous préférons mettre des annotations pour configurer un contexte Spring, il est effectivement possible
  d'utiliser des fichiers de configuration en XML. Historiquement, c'est la manière dont on configurait
  un contexte Spring. Les deux approches (annotations / XML) ont leurs avantages et inconvénients.
  <ul>
    <li>Avantage du XML : la configuration du contexte est indépendante du code Java, ce qui évite 
    de recompiler les classes lors d'un changement de contexte. On maitrise parfaitement ce que contient le contexte, tout étant déclaré.</li>
    <li>Inconvénient : le XML c'est assez pénible à lire, long à écrire, et à "manipuler" ...</li>
  </ul>
  Selon l'utilisation de votre librairie ou de votre application, il peut être intéressant de prévoir
  une configuration par annotation ou par fichier XML. Les deux approches peuvent aussi se mixer.
</p>



<p>
  Le screencast suivant montre comment créer un contexte spring basique constitué de quelques composants. Il présente une approche à l'aide d'annotations et celle à l'aide de fichiers de description xml.
</p>

<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/-IDPUBumnak?rel=0" frameborder="0" allowfullscreen=""></iframe>
</p>

<p align="center">
<a href="https://github.com/gdufrene/mooc_jee_spring/blob/master/week4/screencast/sc12">Code présenté dans le screencast</a>
</p>
